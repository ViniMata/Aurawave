<div class="logs-content">
  <!-- Header da tela -->
  <div class="logs-header">
    <div class="header-info">
      <h1 class="page-title">Logs e Auditoria</h1>
      <p class="page-description">Monitore todas as movimentações e atividades do sistema RFID</p>
    </div>
    
    <!-- Estatísticas rápidas -->
    <div class="quick-stats">
      <div class="stat-item">
        <div class="stat-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M12 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M12 18V22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M4.93 4.93L7.76 7.76" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M16.24 16.24L19.07 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M2 12H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18 12H22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M4.93 19.07L7.76 16.24" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M16.24 7.76L19.07 4.93" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <span class="stat-value">847</span>
          <span class="stat-label">Eventos Hoje</span>
        </div>
      </div>

      
      <div class="stat-item">
        <div class="stat-icon warning">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M10.29 3.86L1.82 18A2 2 0 0 0 3.64 21h16.72a2 2 0 0 0 1.82-3L13.71 3.86a2 2 0 0 0-3.42 0z" stroke="currentColor" stroke-width="2"/>
            <path d="M12 9V13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M12 17H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <span class="stat-value">3</span>
          <span class="stat-label">Alertas</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Filtros e controles -->
  <div class="controls-section">
    <div class="filters">
      <div class="filter-group">
        <label class="filter-label">Período</label>
        <select class="filter-select">
          <option>Últimas 24h</option>
          <option>Última semana</option>
          <option>Último mês</option>
          <option>Personalizado</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label class="filter-label">Tipo de Evento</label>
        <select class="filter-select">
          <option>Todos</option>
          <option>Acesso</option>
          <option>Retirada</option>
          <option>Reposição</option>
          <option>Erro</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label class="filter-label">Colaborador</label>
        <input type="text" class="filter-input" placeholder="Pesquisar colaborador...">
      </div>
    </div>
    
    <div class="actions">
      <button class="btn-secondary">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M3 6H21L19 8H5L3 6Z" stroke="currentColor" stroke-width="2"/>
          <path d="M8 10V16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <path d="M12 10V16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <path d="M16 10V16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Filtrar
      </button>
      
      <button class="btn-primary">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M21 15V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Exportar
      </button>
    </div>
  </div>

  <!-- Tabela moderna -->
  <div class="logs-table-container">
    <div class="table-header">
      <h3 class="table-title">Registro de Atividades</h3>
      <div class="table-info">
        <span class="total-items">{{ (logs$ | async)?.length || 0 }} registros encontrados</span>
      </div>
    </div>
    
    <div class="modern-table">
      <div class="table-header-row">
        <div class="table-cell header">
          <input type="checkbox" class="checkbox">
        </div>
        <div class="table-cell header">Código</div>
        <div class="table-cell header">Produto</div>
        <div class="table-cell header">Colaborador</div>
        <div class="table-cell header">Data & Hora</div>
        <div class="table-cell header">Tipo</div>
        <div class="table-cell header">Status</div>
        <div class="table-cell header">Ações</div>
      </div>
      
      <div class="table-row" *ngFor="let log of logs$ | async; trackBy: trackByFn">
        <div class="table-cell">
          <input type="checkbox" class="checkbox">
        </div>
        <div class="table-cell">
          <div class="code-badge">{{ log.codigoItem }}</div>
        </div>
        <div class="table-cell">
          <div class="product-info">
            <div class="product-name">{{ log.produto || 'Item não identificado' }}</div>
            <div class="product-model">{{ log.modelo || 'Modelo padrão' }}</div>
          </div>
        </div>
        <div class="table-cell">
          <div class="user-info">
            <div class="user-avatar">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M20 21V19A4 4 0 0 0 16 15H8A4 4 0 0 0 4 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <span class="user-name">{{ log.sessoes?.[0]?.colaborador || log.colaborador || 'N/A' }}</span>
          </div>
        </div>
        <div class="table-cell">
          <div class="datetime-info">
            <div class="date">{{ log.dataEvento | date:'dd/MM/yyyy' }}</div>
            <div class="time">{{ log.dataEvento | date:'HH:mm:ss' }}</div>
          </div>
        </div>
        <div class="table-cell">
          <div class="event-badge" [class]="getEventClass(log.tipoEvento)">
            {{ log.tipoEvento || 'Acesso' }}
          </div>
        </div>
        <div class="table-cell">
          <div class="status-badge success">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
              <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Sucesso
          </div>
        </div>
        <div class="table-cell">
          <div class="actions-menu">
            <button class="action-btn" (click)="abrirItens(log, $event)" title="Ver detalhes">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z" stroke="currentColor" stroke-width="2"/>
                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
              </svg>
            </button>
            
            <button class="action-btn" title="Mais informações">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="1" stroke="currentColor" stroke-width="2"/>
                <circle cx="19" cy="12" r="1" stroke="currentColor" stroke-width="2"/>
                <circle cx="5" cy="12" r="1" stroke="currentColor" stroke-width="2"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Paginação -->
    <div class="pagination">
      <div class="pagination-info">
        Mostrando 1-50 de {{ (logs$ | async)?.length || 0 }} registros
      </div>
      
      <div class="pagination-controls">
        <button class="pagination-btn" disabled>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <polyline points="15,18 9,12 15,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        
        <span class="pagination-numbers">
          <button class="pagination-number active">1</button>
          <button class="pagination-number">2</button>
          <button class="pagination-number">3</button>
          <span class="pagination-dots">...</span>
          <button class="pagination-number">10</button>
        </span>
        
        <button class="pagination-btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <polyline points="9,18 15,12 9,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Moderno -->
<div class="modal-overlay" *ngIf="logSelecionado" (click)="fecharModal()">
  <div class="modern-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-title-section">
        <div class="modal-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="modal-title-info">
          <h3 class="modal-title">Detalhes do Log</h3>
          <p class="modal-subtitle">Código: {{ logSelecionado.codigoItem }}</p>
        </div>
      </div>
      
      <button class="close-btn" (click)="fecharModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
    
    <div class="modal-content">
      <!-- Informações principais -->
      <div class="info-section">
        <div class="info-grid">
          <div class="info-item">
            <label class="info-label">Produto</label>
            <span class="info-value">{{ logSelecionado.produto || 'Não identificado' }}</span>
          </div>
          
          <div class="info-item">
            <label class="info-label">Modelo</label>
            <span class="info-value">{{ logSelecionado.modelo || 'Padrão' }}</span>
          </div>
          
          <div class="info-item">
            <label class="info-label">Data do Evento</label>
            <span class="info-value">{{ logSelecionado.dataEvento | date:'dd/MM/yyyy HH:mm:ss' }}</span>
          </div>
          
          <div class="info-item">
            <label class="info-label">Tipo de Evento</label>
            <div class="event-badge-modal" [class]="getEventClass(logSelecionado.tipoEvento)">
              {{ logSelecionado.tipoEvento || 'Acesso' }}
            </div>
          </div>
        </div>
      </div>
      
      <!-- Sessões detalhadas -->
      <div class="sessions-section" *ngIf="logSelecionado.sessoes && logSelecionado.sessoes.length > 0">
        <h4 class="section-title">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
            <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
          </svg>
          Sessões Registradas ({{ logSelecionado.sessoes.length }})
        </h4>
        
        <div class="sessions-list">
          <div class="session-card" *ngFor="let sessao of logSelecionado.sessoes; let i = index">
            <div class="session-number">{{ i + 1 }}</div>
            
            <div class="session-details">
              <div class="session-row">
                <div class="session-field">
                  <label>Colaborador</label>
                  <span>{{ sessao.colaborador || 'N/A' }}</span>
                </div>
                
                <div class="session-field">
                  <label>Local</label>
                  <span>{{ sessao.almoxarifado || 'N/A' }}</span>
                </div>
              </div>
              
              <div class="session-row">
                <div class="session-field">
                  <label>Laboratório</label>
                  <span>{{ sessao.laboratorio || 'N/A' }}</span>
                </div>
                
                <div class="session-field">
                  <label>Duração</label>
                  <span class="duration-badge">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                      <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    {{ calcularDuracao(sessao.inicio, sessao.fim) }}
                  </span>
                </div>
              </div>
              
              <div class="session-timeline">
                <div class="timeline-item">
                  <div class="timeline-dot start"></div>
                  <div class="timeline-content">
                    <span class="timeline-label">Início</span>
                    <span class="timeline-time">{{ sessao.inicio | date:'dd/MM/yyyy HH:mm:ss' }}</span>
                  </div>
                </div>
                
                <div class="timeline-item">
                  <div class="timeline-dot end"></div>
                  <div class="timeline-content">
                    <span class="timeline-label">Fim</span>
                    <span class="timeline-time">{{ sessao.fim | date:'dd/MM/yyyy HH:mm:ss' }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Mensagem quando não há sessões -->
      <div class="empty-state" *ngIf="!logSelecionado.sessoes || logSelecionado.sessoes.length === 0">
        <div class="empty-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="#94a3b8" stroke-width="2"/>
            <path d="M8 12L12 16L16 12" stroke="#94a3b8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h4 class="empty-title">Nenhuma sessão registrada</h4>
        <p class="empty-description">Este evento não possui sessões detalhadas associadas.</p>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="btn-secondary" (click)="fecharModal()">Fechar</button>
      <button class="btn-primary">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M21 15V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Exportar Detalhes
      </button>
    </div>
  </div>
</div>
